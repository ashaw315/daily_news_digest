<div class="container mt-4">
  <div class="card mb-4">
    <div class="card-header">
      <h1>User: <%= @user.email %></h1>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <p><strong>Email:</strong> <%= @user.email %></p>
          <p><strong>Subscribed:</strong> <%= @user.is_subscribed? ? 'Yes' : 'No' %></p>
          <p><strong>Admin:</strong> <%= @user.admin? ? 'Yes' : 'No' %></p>
          <p><strong>Created:</strong> <%= @user.created_at.strftime('%Y-%m-%d %H:%M:%S') %></p>
          <p><strong>Last Updated:</strong> <%= @user.updated_at.strftime('%Y-%m-%d %H:%M:%S') %></p>
        </div>
        <div class="col-md-6">
          <p><strong>Email Frequency:</strong> <%= @user.email_frequency %></p>
          <p><strong>Unsubscribe Token:</strong> <%= @user.unsubscribe_token %></p>
        </div>
      </div>
      
      <div class="mt-3">
        <%= link_to 'Back to Users', admin_users_path, class: 'btn btn-secondary' %>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-6">
      <div class="card mb-4">
        <div class="card-header">
          <h3>Topics (<%= @topics.count %>)</h3>
        </div>
        <div class="card-body">
          <% if @topics.any? %>
            <ul class="list-group">
              <% @topics.each do |topic| %>
                <li class="list-group-item"><%= topic.name %></li>
              <% end %>
            </ul>
          <% else %>
            <p>No topics selected.</p>
          <% end %>
        </div>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="card mb-4">
        <div class="card-header">
          <h3>News Sources (<%= @news_sources.count %>)</h3>
        </div>
        <div class="card-body">
          <% if @news_sources.any? %>
            <ul class="list-group">
              <% @news_sources.each do |source| %>
                <li class="list-group-item"><%= source.name %></li>
              <% end %>
            </ul>
          <% else %>
            <p>No news sources selected.</p>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3>Recent Email Metrics</h3>
    </div>
    <div class="card-body">
      <% if @email_metrics.any? %>
        <table class="table">
          <thead>
            <tr>
              <th>Type</th>
              <th>Sent At</th>
              <th>Status</th>
              <th>Subject</th>
            </tr>
          </thead>
          <tbody>
            <% @email_metrics.each do |metric| %>
              <tr>
                <td><%= metric.email_type %></td>
                <td><%= metric.sent_at&.strftime('%Y-%m-%d %H:%M:%S') %></td>
                <td><%= metric.status %></td>
                <td><%= metric.subject %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% else %>
        <p>No email metrics available.</p>
      <% end %>
    </div>
  </div>
</div>